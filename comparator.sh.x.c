#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -vrf comparator.sh -o dns_security_analysis 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\000\272\025"
#define      chk1_z	22
#define      chk1	((&data[8]))
	"\007\134\227\333\120\135\176\005\305\136\063\120\073\356\144\204"
	"\242\224\103\074\215\343\321\140\224\323\234\124\255\307\215\326"
#define      rlax_z	1
#define      rlax	((&data[35]))
	"\357"
#define      xecc_z	15
#define      xecc	((&data[38]))
	"\317\344\114\267\163\307\171\336\013\205\325\303\015\017\014\135"
	"\164"
#define      text_z	6309
#define      text	((&data[593]))
	"\006\023\352\157\141\227\225\371\177\212\001\334\041\334\054\166"
	"\212\363\003\140\245\333\272\013\226\355\332\173\305\062\276\314"
	"\105\251\073\247\101\321\241\300\133\242\234\175\177\311\363\011"
	"\274\367\152\141\322\044\155\151\022\110\345\327\172\244\243\300"
	"\115\337\150\217\260\011\120\014\253\355\211\052\266\174\064\163"
	"\164\236\325\107\303\102\260\325\212\226\255\005\072\120\305\210"
	"\060\056\027\340\067\150\354\343\125\166\016\014\363\103\177\147"
	"\341\124\256\244\227\137\172\041\365\047\046\057\170\354\267\250"
	"\032\317\211\122\067\165\066\215\354\104\231\337\210\030\106\151"
	"\155\364\016\004\123\211\046\110\260\115\170\051\071\060\321\124"
	"\377\132\247\067\320\335\304\274\042\135\233\252\166\342\023\343"
	"\327\042\350\052\253\016\163\134\133\354\205\225\034\127\352\034"
	"\262\221\124\202\156\030\077\220\166\333\073\355\275\117\321\224"
	"\161\271\277\035\310\063\171\044\037\377\271\074\126\243\130\010"
	"\065\254\213\243\305\312\064\074\245\157\052\143\277\373\370\060"
	"\265\267\116\175\353\310\241\012\307\133\107\036\376\240\047\064"
	"\115\262\327\023\175\014\117\043\174\171\206\073\165\177\154\052"
	"\066\273\250\042\203\111\055\112\244\164\151\243\024\220\327\141"
	"\103\257\164\300\273\304\343\070\076\152\164\264\351\340\336\040"
	"\233\206\102\037\320\157\152\164\344\323\030\370\143\357\132\246"
	"\237\317\147\133\224\113\223\322\266\007\206\240\350\145\300\204"
	"\354\003\243\274\163\015\060\127\341\111\120\104\071\253\353\330"
	"\173\123\063\017\236\307\342\124\317\150\364\270\316\265\074\272"
	"\271\340\166\055\356\247\205\317\360\325\024\051\201\000\002\374"
	"\123\066\013\362\375\355\107\315\126\074\205\044\362\302\337\253"
	"\243\125\330\222\375\136\141\355\064\166\027\265\167\032\262\313"
	"\120\275\275\116\253\004\033\002\100\241\047\063\143\006\336\007"
	"\134\267\231\131\025\373\107\111\162\137\377\351\171\261\264\312"
	"\157\161\030\033\166\064\035\267\326\104\352\072\113\311\101\247"
	"\200\332\000\226\326\110\340\110\250\337\061\041\221\346\354\000"
	"\130\005\033\316\071\071\206\017\175\161\111\310\072\213\157\273"
	"\145\160\121\073\271\062\204\141\022\265\203\243\233\157\244\363"
	"\164\300\302\256\371\110\276\166\272\010\077\364\223\257\257\371"
	"\040\001\065\331\064\271\073\106\157\276\352\012\223\326\120\110"
	"\316\210\312\172\214\356\234\226\247\047\045\152\260\102\027\007"
	"\055\167\032\100\012\117\024\326\231\262\210\124\062\220\301\056"
	"\302\320\047\045\122\340\146\337\024\342\356\260\162\212\014\070"
	"\203\324\261\027\120\142\172\111\015\102\000\000\053\273\231\347"
	"\340\104\112\042\273\377\203\066\255\276\072\154\330\261\233\316"
	"\137\031\216\013\166\004\160\320\065\236\154\300\050\053\311\077"
	"\216\234\323\301\117\334\353\235\107\120\302\243\362\146\147\232"
	"\010\335\226\371\377\067\326\355\047\175\210\020\103\027\102\302"
	"\262\272\267\227\134\054\240\143\247\176\265\126\276\340\137\357"
	"\241\266\226\155\047\162\332\324\364\375\343\155\216\105\276\120"
	"\045\354\320\271\242\247\336\237\347\332\132\340\265\034\373\135"
	"\037\154\047\012\164\134\105\376\034\270\367\272\214\274\032\135"
	"\122\305\365\324\204\054\007\254\233\205\203\240\177\252\131\111"
	"\351\355\140\204\176\044\124\052\212\134\160\235\123\366\137\370"
	"\137\265\323\230\354\135\023\375\123\117\225\024\200\162\114\016"
	"\065\333\116\140\160\357\236\170\277\043\220\276\061\173\035\023"
	"\067\233\226\043\131\075\363\373\012\027\312\124\130\351\264\044"
	"\336\017\012\161\035\353\232\223\357\250\350\307\125\025\150\375"
	"\112\027\355\314\346\373\047\162\170\304\057\305\367\375\224\333"
	"\351\275\004\323\215\172\120\043\030\306\313\251\210\250\314\351"
	"\303\312\031\246\053\324\031\177\220\341\352\077\051\327\007\226"
	"\144\140\024\010\203\205\353\035\247\110\055\252\244\262\036\112"
	"\141\273\137\111\361\322\150\271\102\325\213\053\375\340\162\377"
	"\321\300\362\370\101\343\176\201\011\352\036\324\057\110\026\073"
	"\134\254\222\143\365\363\102\101\216\072\144\226\055\303\212\344"
	"\116\337\266\071\026\063\135\117\101\352\232\206\204\245\114\074"
	"\363\006\370\041\247\145\146\347\315\255\105\313\132\020\205\045"
	"\055\060\162\345\133\325\335\026\376\041\155\176\200\265\310\240"
	"\006\074\376\374\023\305\215\031\153\047\067\100\120\046\341\277"
	"\037\041\153\216\106\030\306\166\000\342\235\336\250\342\065\003"
	"\061\076\022\150\072\335\223\136\074\113\114\124\366\161\052\123"
	"\033\071\207\263\276\335\165\056\054\037\141\000\365\005\013\001"
	"\061\130\344\350\143\056\157\067\261\313\261\335\230\356\207\176"
	"\212\307\155\252\110\054\353\376\306\323\135\210\240\341\114\155"
	"\243\002\324\167\217\025\244\041\013\220\270\227\030\031\241\241"
	"\275\343\336\174\163\312\042\025\235\033\146\365\156\241\104\047"
	"\205\033\161\206\111\043\371\026\146\363\042\231\253\236\041\205"
	"\267\036\313\126\212\124\311\121\045\152\233\254\105\204\153\210"
	"\064\247\001\014\356\054\321\075\133\252\201\125\312\256\004\263"
	"\144\111\010\360\323\025\174\213\254\206\367\026\066\337\025\313"
	"\345\076\306\170\150\123\024\005\372\272\030\101\167\156\157\352"
	"\256\267\246\300\103\331\111\131\345\116\030\276\014\055\262\145"
	"\206\107\261\262\011\127\034\250\140\035\261\300\152\234\277\371"
	"\142\137\033\026\342\350\117\302\372\134\212\331\204\107\223\266"
	"\302\242\343\164\054\024\017\175\004\244\337\221\262\313\323\166"
	"\136\141\050\155\000\037\300\164\211\134\112\270\001\360\343\211"
	"\101\124\324\277\062\320\020\240\111\177\147\221\122\106\111\114"
	"\211\120\137\016\344\144\013\265\231\272\211\130\377\244\067\222"
	"\337\125\373\346\372\254\326\100\374\244\313\337\130\323\273\101"
	"\165\267\336\255\051\045\207\064\130\304\030\356\325\041\071\374"
	"\366\071\067\275\150\010\373\076\330\247\371\267\160\310\303\174"
	"\015\235\317\114\114\173\162\375\004\203\214\043\255\002\111\122"
	"\201\225\244\106\013\103\003\252\027\317\156\173\320\106\000\115"
	"\010\106\072\150\241\236\104\327\253\143\002\262\126\132\050\123"
	"\111\215\227\164\233\071\364\014\261\045\214\231\152\046\201\345"
	"\146\066\060\137\371\262\167\055\276\106\265\161\165\063\045\161"
	"\021\356\230\004\342\030\107\146\025\126\221\271\041\101\013\216"
	"\015\170\305\014\157\161\106\207\214\012\326\311\337\103\371\162"
	"\053\030\307\114\010\351\305\065\144\223\027\356\034\173\160\134"
	"\020\056\362\367\157\041\362\003\257\315\057\112\250\241\074\336"
	"\245\327\113\226\365\023\071\055\076\160\201\034\071\104\146\156"
	"\350\371\211\307\015\010\354\045\265\274\162\233\312\337\176\354"
	"\141\260\266\025\224\344\136\025\012\320\020\130\240\114\037\061"
	"\072\073\133\151\151\001\166\253\177\174\064\217\145\012\026\004"
	"\306\210\273\313\200\236\266\227\117\335\050\331\260\261\131\326"
	"\367\126\271\350\336\206\204\257\050\220\253\300\334\174\353\033"
	"\051\345\170\232\362\000\276\065\260\131\350\040\041\023\247\172"
	"\236\012\020\075\372\246\157\062\104\323\172\034\202\147\261\213"
	"\240\331\167\213\227\200\305\076\024\272\250\010\367\325\102\171"
	"\010\113\054\300\363\244\223\053\135\340\372\313\103\127\045\246"
	"\170\111\033\111\314\277\075\135\274\034\173\136\121\370\300\352"
	"\263\310\163\351\373\073\056\051\340\053\344\122\245\166\240\072"
	"\105\175\306\157\114\323\347\320\326\310\321\223\114\322\330\076"
	"\314\176\335\177\335\235\005\125\076\275\102\230\374\125\365\061"
	"\017\234\172\267\072\001\214\102\317\372\227\354\350\175\264\067"
	"\121\302\017\156\006\337\206\006\252\135\152\322\104\027\246\215"
	"\044\374\351\331\043\017\377\273\352\025\310\315\001\013\021\105"
	"\033\331\142\174\016\053\340\071\077\162\104\346\123\105\215\055"
	"\137\104\032\337\267\065\166\273\307\075\172\043\125\323\314\225"
	"\266\204\277\212\067\062\053\102\333\036\065\202\015\175\365\155"
	"\311\066\215\237\056\052\152\334\220\146\266\135\037\053\245\174"
	"\117\120\022\005\045\013\370\222\331\324\260\311\107\062\365\155"
	"\037\250\104\131\026\054\147\326\225\110\341\110\053\077\166\126"
	"\213\324\151\104\031\313\302\361\147\277\024\104\262\266\001\316"
	"\036\370\155\030\051\157\306\332\234\272\156\012\015\201\203\062"
	"\232\323\256\036\227\240\105\171\320\316\257\160\262\302\340\257"
	"\226\113\132\324\122\123\141\037\015\345\172\006\223\023\211\322"
	"\240\233\233\222\066\020\361\244\052\204\054\135\254\343\266\373"
	"\174\052\103\343\354\237\247\254\126\043\377\206\350\366\032\063"
	"\242\174\332\364\260\256\307\034\006\372\143\132\107\177\032\251"
	"\240\112\124\347\076\131\146\125\071\234\114\362\332\064\225\000"
	"\364\074\220\313\071\270\035\275\326\332\272\234\176\001\315\172"
	"\136\210\160\107\322\054\003\246\224\376\032\052\254\066\333\164"
	"\023\341\073\265\101\152\043\021\147\337\007\022\011\151\302\230"
	"\213\175\260\106\204\213\336\210\111\022\274\356\235\307\377\011"
	"\165\136\047\065\147\003\135\143\124\011\072\335\177\165\210\163"
	"\320\157\147\332\133\160\231\225\221\051\126\031\362\036\305\017"
	"\002\253\050\014\202\124\117\102\346\127\144\155\232\337\213\167"
	"\245\002\221\273\072\026\041\325\271\372\337\131\322\036\236\351"
	"\115\150\146\303\371\310\212\342\203\265\227\143\103\171\120\327"
	"\303\363\030\303\060\337\013\305\366\147\124\267\136\236\305\000"
	"\204\000\334\271\312\266\346\160\034\031\363\262\104\310\341\370"
	"\161\272\343\316\156\220\012\326\261\073\313\333\244\222\255\070"
	"\013\131\130\242\140\147\105\375\016\027\150\314\263\102\223\221"
	"\247\133\147\253\036\110\101\157\174\005\361\061\257\314\121\173"
	"\063\074\011\361\070\027\221\111\211\154\005\053\212\142\331\266"
	"\215\242\200\260\225\245\230\063\226\201\362\341\120\257\222\353"
	"\304\265\071\137\021\176\105\240\233\321\221\216\145\372\251\062"
	"\210\255\014\127\345\067\000\050\336\042\165\215\361\240\164\350"
	"\200\370\300\044\160\217\233\106\070\244\236\212\232\325\043\240"
	"\067\336\177\334\323\106\102\024\034\174\255\040\260\260\251\147"
	"\346\310\227\330\100\021\045\327\214\051\120\342\206\220\252\116"
	"\346\304\373\256\206\255\314\223\351\314\110\110\252\111\023\337"
	"\132\272\160\132\117\256\244\211\211\027\263\050\126\261\144\250"
	"\015\136\003\376\353\134\040\327\355\217\364\316\207\312\007\076"
	"\205\143\312\354\000\134\121\317\273\331\274\344\154\023\117\030"
	"\362\244\212\365\170\012\312\301\135\007\122\170\016\011\170\152"
	"\342\253\157\352\357\356\017\147\343\320\031\037\240\374\127\001"
	"\203\035\357\231\352\105\022\103\221\203\106\060\075\047\236\045"
	"\340\306\111\122\047\010\037\147\350\107\370\175\375\337\003\071"
	"\033\152\230\254\166\227\016\015\065\025\372\332\342\147\316\315"
	"\343\247\036\041\366\101\132\233\113\151\175\324\143\320\112\125"
	"\237\247\067\200\366\371\063\307\321\307\072\216\134\100\365\374"
	"\073\031\207\254\361\263\070\272\257\103\160\204\375\137\343\260"
	"\221\077\160\015\127\350\022\252\061\036\267\251\004\202\363\002"
	"\345\311\356\047\123\305\131\245\141\304\330\300\354\231\251\061"
	"\145\117\121\353\261\102\103\076\376\226\143\375\070\362\204\012"
	"\147\226\017\136\063\131\154\264\234\356\255\131\252\324\321\000"
	"\175\216\067\056\350\014\234\132\216\352\101\365\067\341\150\216"
	"\216\300\214\214\376\227\362\131\056\263\253\050\026\136\266\250"
	"\150\322\164\016\005\030\355\247\031\122\271\022\304\135\260\215"
	"\214\052\114\275\026\071\134\116\310\134\073\314\022\136\276\237"
	"\041\357\351\063\207\373\373\363\302\303\064\133\171\273\262\124"
	"\212\240\057\136\026\347\053\115\320\367\061\373\040\326\261\221"
	"\307\154\375\036\302\011\177\163\116\245\066\123\255\172\267\054"
	"\051\121\317\153\267\251\327\230\150\162\006\117\251\267\033\226"
	"\164\302\006\134\055\200\246\124\166\220\256\174\370\013\163\273"
	"\365\074\303\126\066\246\055\111\024\165\267\163\302\057\156\337"
	"\013\007\050\321\030\214\214\042\323\237\363\316\022\242\013\341"
	"\224\312\046\154\366\141\245\114\246\244\042\102\304\177\126\312"
	"\305\235\270\223\000\005\160\205\000\021\207\305\205\267\053\144"
	"\014\262\311\161\334\345\171\132\132\171\027\372\302\325\061\145"
	"\150\033\320\061\303\155\075\170\307\177\076\223\004\156\245\166"
	"\335\267\312\152\151\304\173\251\201\031\260\156\212\317\363\204"
	"\046\201\077\034\274\115\234\371\022\001\106\064\342\144\146\375"
	"\351\335\355\150\165\222\107\002\120\061\175\327\122\243\150\220"
	"\145\005\210\216\101\145\100\166\163\144\243\075\236\232\344\170"
	"\221\310\046\311\055\257\227\056\364\227\020\067\260\272\062\026"
	"\205\045\343\312\001\145\016\075\267\237\145\012\013\320\357\001"
	"\360\266\030\046\050\160\033\045\202\333\367\226\220\315\107\307"
	"\234\312\052\265\041\205\066\031\145\365\151\061\317\202\302\111"
	"\075\132\106\164\247\366\147\100\235\161\130\302\010\366\233\124"
	"\164\035\355\132\061\117\300\337\205\223\337\322\252\303\332\307"
	"\203\222\063\203\376\063\154\257\323\020\274\051\146\277\137\231"
	"\366\224\231\360\114\032\323\006\017\031\106\262\210\131\310\276"
	"\264\021\211\000\374\041\055\222\303\032\004\263\027\267\105\321"
	"\027\032\066\036\335\046\012\303\172\317\002\206\202\073\000\072"
	"\076\011\212\330\044\260\315\366\213\134\165\304\222\263\007\067"
	"\043\266\362\066\044\120\117\077\167\156\044\154\055\214\055\313"
	"\014\275\306\270\010\307\126\116\120\065\361\315\175\271\146\332"
	"\141\067\026\111\364\063\174\350\151\343\342\063\044\330\020\034"
	"\103\114\030\133\026\257\236\341\171\171\352\000\276\251\271\314"
	"\100\361\034\027\065\151\123\044\366\234\044\137\044\036\016\246"
	"\166\104\036\035\205\116\055\131\200\155\256\053\054\101\016\107"
	"\070\166\374\301\211\256\374\114\223\340\223\330\232\164\207\063"
	"\253\022\040\220\013\152\134\225\116\202\005\016\374\255\325\231"
	"\157\336\256\012\063\114\260\320\145\204\176\336\345\020\332\010"
	"\326\235\333\130\352\371\130\240\155\331\315\060\351\032\356\272"
	"\372\350\015\345\302\272\341\156\372\114\306\321\250\353\045\153"
	"\040\273\257\234\132\173\137\310\135\033\325\016\145\267\237\034"
	"\071\017\363\121\145\321\060\054\166\111\072\067\274\205\236\266"
	"\267\017\244\354\137\257\034\142\237\225\102\301\303\376\031\061"
	"\010\026\101\273\016\313\133\067\005\310\112\046\205\270\014\167"
	"\202\070\204\053\243\352\325\013\104\111\107\175\177\113\052\250"
	"\214\315\337\175\362\162\240\350\370\225\235\114\034\073\001\071"
	"\351\122\211\216\054\046\317\212\076\140\326\104\126\364\335\242"
	"\071\335\210\104\230\347\260\365\143\275\351\233\212\140\255\332"
	"\142\217\012\362\102\155\371\154\361\377\352\002\303\014\137\317"
	"\012\363\135\322\373\141\333\074\071\261\012\076\123\343\243\154"
	"\034\265\003\334\137\371\265\010\166\057\135\157\113\100\313\202"
	"\041\063\000\014\057\001\036\230\220\070\147\031\277\251\314\030"
	"\176\022\245\065\323\250\255\136\364\221\346\351\166\241\123\234"
	"\364\337\321\262\354\241\200\101\164\326\372\166\244\172\217\333"
	"\314\367\374\220\374\147\056\315\151\343\041\022\000\341\360\043"
	"\161\320\013\322\350\235\202\347\136\231\104\342\052\342\330\275"
	"\202\145\121\046\116\242\315\075\223\137\046\005\317\121\054\065"
	"\164\041\020\067\017\201\326\023\210\024\203\314\162\033\054\322"
	"\303\061\016\106\300\014\243\276\262\115\057\010\335\164\226\270"
	"\126\024\333\073\113\047\275\015\326\216\335\375\052\064\061\247"
	"\052\314\172\112\356\040\025\364\152\002\065\341\330\336\316\343"
	"\350\202\214\075\316\067\171\274\017\365\215\176\327\274\251\153"
	"\311\365\332\374\325\015\170\056\305\057\334\234\200\063\326\366"
	"\330\325\215\050\044\100\137\104\050\367\301\366\166\031\354\041"
	"\260\163\071\354\036\234\301\134\372\251\133\301\204\004\212\066"
	"\141\172\045\250\331\270\253\220\371\372\257\271\045\012\252\311"
	"\375\374\234\220\150\154\105\301\314\064\144\041\254\370\103\013"
	"\073\103\035\170\216\301\141\161\257\056\072\041\063\265\003\252"
	"\052\130\013\174\325\277\152\020\240\214\237\351\372\260\201\072"
	"\071\156\044\144\266\176\222\133\343\203\140\222\111\361\165\034"
	"\263\060\227\105\172\106\004\070\211\077\013\121\006\237\127\165"
	"\112\023\242\021\337\376\226\305\377\370\164\025\025\164\312\203"
	"\251\247\347\101\264\207\253\237\350\373\311\077\174\137\214\216"
	"\026\227\363\034\236\341\251\163\326\147\122\362\232\106\016\324"
	"\173\320\277\022\221\145\320\045\271\111\056\230\365\034\217\206"
	"\256\273\156\241\332\244\050\365\375\120\010\006\375\352\121\234"
	"\253\207\337\313\075\357\332\163\025\021\132\005\364\353\010\015"
	"\306\270\161\076\204\050\376\217\011\054\276\012\151\002\270\220"
	"\312\244\124\311\161\224\164\001\363\005\153\357\022\155\323\172"
	"\044\251\257\324\260\335\343\016\026\366\210\155\216\307\252\331"
	"\063\111\315\174\251\066\114\326\267\010\367\374\017\336\170\203"
	"\000\013\117\275\072\100\043\214\237\320\103\145\156\310\324\173"
	"\346\111\160\362\270\105\153\042\020\164\241\147\271\204\314\114"
	"\243\212\067\205\066\307\341\276\034\370\232\314\167\121\303\021"
	"\327\067\147\245\161\022\041\273\063\131\025\000\352\071\166\271"
	"\363\206\163\135\320\041\373\347\025\074\154\346\356\244\071\040"
	"\043\275\327\261\155\077\177\035\160\030\251\251\347\216\337\022"
	"\106\026\026\255\333\244\115\326\031\355\053\141\230\073\112\335"
	"\346\115\350\250\235\233\140\340\334\347\126\332\070\052\327\167"
	"\116\172\140\354\054\357\156\373\120\354\354\001\307\023\060\376"
	"\020\161\055\121\071\041\372\252\124\174\012\330\372\170\351\065"
	"\162\177\131\362\146\111\042\257\166\260\347\353\270\010\271\156"
	"\176\234\131\023\013\227\004\316\245\370\147\223\350\100\314\061"
	"\152\345\365\304\317\326\255\000\002\217\137\033\174\221\173\016"
	"\074\223\370\342\137\076\102\223\365\335\262\343\273\263\253\075"
	"\252\364\114\072\335\364\253\161\142\221\007\000\332\302\244\327"
	"\366\053\255\216\312\374\021\147\072\144\270\035\273\312\226\221"
	"\203\011\161\215\346\103\027\026\146\024\315\127\162\230\020\027"
	"\120\364\014\131\300\134\241\272\222\304\315\161\001\335\275\332"
	"\225\034\362\123\304\203\123\365\246\337\343\166\332\343\164\020"
	"\036\222\165\064\112\061\173\102\062\073\337\031\237\310\056\045"
	"\327\037\143\342\225\217\221\006\015\203\045\123\357\134\217\116"
	"\064\223\364\341\200\103\255\151\002\356\121\372\211\047\246\032"
	"\241\271\162\153\174\236\235\021\264\307\343\250\115\222\112\133"
	"\326\022\365\005\114\024\327\071\223\060\320\256\226\200\042\012"
	"\360\322\150\315\362\236\021\324\235\134\014\260\047\322\377\016"
	"\240\134\202\111\064\115\274\136\110\167\251\030\065\257\337\367"
	"\221\337\315\354\177\176\162\005\005\373\356\053\372\302\135\107"
	"\305\163\333\273\346\061\162\057\145\256\010\211\347\352\256\046"
	"\021\161\230\367\330\364\101\267\120\227\322\010\200\202\334\211"
	"\123\224\354\162\107\351\156\005\327\115\205\007\273\022\014\327"
	"\357\333\217\153\326\222\067\177\140\015\313\112\060\250\112\314"
	"\047\024\053\321\221\210\261\077\220\141\322\347\324\112\307\314"
	"\261\113\274\314\300\356\224\134\014\302\002\277\022\054\052\361"
	"\041\047\205\050\251\253\370\322\270\231\113\152\254\034\272\171"
	"\055\366\273\223\056\337\140\372\276\056\001\017\246\101\101\136"
	"\377\343\270\243\350\000\015\002\273\246\275\335\111\020\143\233"
	"\173\245\043\005\025\210\002\036\073\040\210\213\013\154\375\165"
	"\225\034\070\015\247\004\257\061\314\262\236\145\200\140\162\007"
	"\377\310\304\060\155\157\303\072\351\271\316\010\350\103\252\331"
	"\373\035\145\144\246\311\237\027\152\110\021\240\240\131\125\246"
	"\004\007\266\107\377\052\117\236\355\025\277\004\121\150\034\114"
	"\137\367\323\134\206\160\110\010\031\200\375\226\330\377\013\274"
	"\217\251\336\234\214\206\165\265\144\245\051\165\365\232\200\350"
	"\301\167\052\205\355\367\012\137\201\072\171\125\350\044\265\345"
	"\331\314\117\255\211\122\055\056\247\071\101\054\365\044\016\336"
	"\065\001\014\147\364\146\331\213\330\277\033\362\035\244\114\164"
	"\077\014\336\310\064\140\141\341\004\227\143\147\321\115\353\045"
	"\271\175\362\032\024\200\175\226\023\133\357\220\020\073\102\261"
	"\217\375\243\231\120\266\250\275\354\326\033\326\171\375\275\341"
	"\167\004\202\053\152\176\130\020\176\136\256\167\266\056\101\005"
	"\172\067\345\361\366\123\260\170\201\136\166\012\156\153\263\245"
	"\117\014\261\373\015\344\201\035\056\026\222\032\341\262\265\170"
	"\363\314\261\154\341\176\153\342\160\171\254\175\246\331\252\152"
	"\307\324\014\000\011\023\260\253\305\122\167\102\135\253\241\045"
	"\360\134\055\220\244\367\065\271\326\376\004\071\230\321\213\275"
	"\063\045\337\232\326\022\250\242\121\142\033\056\044\140\221\173"
	"\244\213\342\335\343\002\317\233\161\146\012\351\031\200\115\057"
	"\067\240\123\266\171\233\344\177\007\252\025\203\302\316\314\126"
	"\352\155\114\325\201\136\327\236\116\140\222\051\324\236\031\077"
	"\043\231\260\055\047\325\226\253\371\052\006\077\251\073\343\215"
	"\121\150\257\330\323\172\241\373\071\131\012\155\355\150\320\377"
	"\276\347\230\110\114\334\225\020\171\070\174\252\257\100\215\130"
	"\257\011\050\147\205\077\054\050\045\050\151\016\366\034\124\202"
	"\030\021\063\275\266\035\246\052\371\262\234\033\075\065\252\276"
	"\107\226\256\362\341\036\143\356\253\323\304\355\244\111\172\225"
	"\030\123\115\034\016\130\271\356\311\153\363\252\376\320\141\305"
	"\216\363\074\143\047\135\372\035\316\015\225\243\304\020\272\334"
	"\116\025\372\320\374\127\104\033\257\231\026\145\160\005\165\331"
	"\101\365\270\156\037\065\257\070\207\250\231\025\101\333\327\201"
	"\301\134\067\142\324\004\364\152\307\301\140\275\032\102\061\116"
	"\217\170\046\306\116\320\340\065\321\367\223\012\357\342\127\023"
	"\131\266\145\135\036\013\066\321\215\146\027\060\045\177\157\140"
	"\130\151\073\303\325\115\021\151\001\073\071\331\123\153\312\056"
	"\075\105\161\373\061\320\050\145\034\201\136\245\340\073\101\001"
	"\227\330\332\167\170\301\147\310\107\223\252\207\060\073\205\301"
	"\307\020\072\123\066\174\306\230\144\246\261\175\000\261\363\164"
	"\036\122\026\136\002\050\104\316\344\040\175\157\055\073\202\135"
	"\105\135\365\332\271\035\114\025\231\104\323\234\255\226\333\271"
	"\303\374\035\057\125\116\105\055\023\031\133\114\102\144\141\344"
	"\221\247\076\377\213\246\115\353\304\075\276\137\104\073\371\104"
	"\330\164\172\142\263\060\171\005\152\227\312\151\377\240\361\367"
	"\311\127\047\275\352\121\063\145\230\310\054\247\074\101\364\154"
	"\351\252\322\106\052\135\220\266\030\377\063\236\247\313\051\361"
	"\311\114\154\147\060\272\312\123\314\314\022\247\327\242\073\171"
	"\011\024\165\345\015\271\150\067\062\373\277\246\273\353\034\361"
	"\050\266\276\155\330\347\016\120\026\357\272\110\322\233\370\021"
	"\132\363\037\331\024\142\225\234\157\015\246\254\051\377\347\017"
	"\276\371\042\266\103\260\136\112\072\322\025\240\046\326\152\336"
	"\231\074\372\123\340\154\114\301\250\232\114\131\120\117\306\314"
	"\266\322\134\147\142\047\074\111\130\216\015\227\333\207\330\373"
	"\375\203\224\222\052\022\352\031\355\145\147\051\042\240\327\374"
	"\144\320\272\356\225\235\300\071\321\357\104\140\135\345\052\354"
	"\342\061\023\040\317\153\377\364\223\117\302\217\216\376\205\257"
	"\047\016\332\126\343\204\233\361\212\311\134\002\317\121\211\364"
	"\357\373\242\160\033\066\364\250\023\005\205\063\375\071\245\315"
	"\162\300\140\372\045\073\056\320\223\371\141\253\265\105\134\304"
	"\242\215\211\156\203\322\257\176\133\374\346\371\045\202\114\042"
	"\372\214\214\334\210\015\314\177\007\227\142\261\151\141\177\343"
	"\243\325\076\242\200\273\002\153\110\124\140\341\051\063\301\273"
	"\216\135\174\005\153\162\152\155\160\276\231\217\064\047\156\324"
	"\176\157\366\047\041\071\232\300\105\205\052\060\235\214\006\100"
	"\204\064\152\231\174\167\216\166\065\056\377\211\201\237\156\227"
	"\072\327\322\373\311\170\174\152\325\151\304\212\073\201\176\376"
	"\123\027\061\146\300\214\004\027\235\267\235\361\365\242\246\277"
	"\052\364\167\123\262\304\051\170\070\201\117\212\160\157\361\113"
	"\112\117\025\117\225\064\310\045\253\112\037\154\020\113\100\161"
	"\376\034\260\121\122\300\163\324\244\262\310\057\176\276\034\174"
	"\343\070\101\005\355\353\120\244\234\102\125\251\153\334\317\227"
	"\145\173\062\231\063\357\053\102\011\072\070\034\100\200\133\051"
	"\107\207\112\015\045\045\222\340\003\047\167\125\265\103\207\242"
	"\363\334\342\314\372\124\077\163\333\315\307\050\044\347\033\275"
	"\045\323\304\102\132\012\135\303\004\331\173\031\242\210\205\130"
	"\325\063\242\053\055\111\173\332\315\345\054\051\061\105\136\267"
	"\022\115\235\053\131\257\171\140\336\064\315\370\261\200\062\174"
	"\074\072\377\340\042\355\152\044\105\010\150\301\122\301\012\011"
	"\011\012\324\275\146\123\166\337\341\101\375\161\030\076\145\101"
	"\173\174\064\036\244\226\166\335\110\321\241\315\135\317\176\065"
	"\060\122\374\167\240\363\066\174\106\177\203\042\205\050\220\265"
	"\247\173\206\343\134\113\231\061\121\114\344\233\120\127\235\053"
	"\030\060\100\347\027\241\275\055\306\006\353\261\162\355\264\161"
	"\256\063\332\304\237\061\007\025\134\013\067\113\270\377\342\141"
	"\314\113\315\051\325\023\244\223\327\152\074\004\035\051\104\034"
	"\367\170\100\033\315\212\122\033\330\347\102\026\200\313\065\031"
	"\177\271\331\227\255\220\063\060\307\167\363\275\200\004\326\017"
	"\007\042\246\175\202\054\215\167\171\222\153\272\246\375\345\265"
	"\306\150\175\251\070\170\243\272\344\275\273\174\266\353\214\242"
	"\125\202\147\123\035\361\303\101\260\251\216\304\131\136\130\323"
	"\015\362\017\276\106\267\015\362\354\221\317\147\035\046\041\165"
	"\263\306\021\133\156\235\362\057\020\065\226\377\011\145\342\211"
	"\067\374\002\162\221\203\116\102\376\232\231\127\330\373\251\067"
	"\254\357\253\037\242\226\202\160\032\256\016\023\241\153\243\043"
	"\062\142\010\274\031\350\027\111\371\060\047\130\315\027\020\323"
	"\136\216\014\045\254\043\174\275\173\006\362\163\176\277\010\267"
	"\051\043\240\204\217\226\370\114\042\235\012\232\121\121\262\313"
	"\177\310\204\070\160\021\150\373\367\165\252\016\321\170\135\320"
	"\322\115\346\223\376\277\343\100\265\352\330\305\143\160\364\333"
	"\043\315\002\054\207\345\205\340\314\010\034\113\237\066\313\161"
	"\151\013\246\134\362\361\113\260\226\353\135\354\060\061\070\267"
	"\346\024\307\010\022\007\251\035\364\353\117\312\263\351\372\314"
	"\373\047\274\046\374\021\077\023\254\006\011\033\335\272\063\057"
	"\245\246\126\044\262\244\172\035\060\142\354\207\147\230\053\215"
	"\124\372\075\361\052\334\352\350\127\013\014\001\231\350\103\020"
	"\175\062\066\260\377\324\167\343\107\217\141\136\115\174\177\354"
	"\251\373\354\362\070\157\206\203\220\336\061\014\012\360\374\372"
	"\170\232\347\344\365\014\162\143\166\370\240\151\070\213\223\124"
	"\170\115\004\001\072\241\071\062\077\353\314\253\277\072\153\247"
	"\163\051\143\336\110\320\272\216\362\101\276\334\246\333\375\077"
	"\114\377\201\111\353\340\113\303\106\200\056\223\364\305\245\077"
	"\274\042\134\055\371\231\116\062\147\157\014\311\172\045\305\013"
	"\045\071\165\025\204\130\112\342\262\010\037\167\253\225\312\270"
	"\136\106\354\157\250\256\367\156\277\264\064\233\321\210\234\300"
	"\201\316\065\316\002\235\037\001\254\166\142\330\065\375\274\232"
	"\010\353\074\040\031\121\016\303\156\072\102\067\360\250\214\135"
	"\301\250\216\356\014\201\147\233\222\316\306\275\253\034\021\277"
	"\110\222\046\357\356\036\155\375\300\325\250\066\247\226\101\306"
	"\360\110\066\010\225\004\376\113\036\363\014\067\015\257\276\306"
	"\315\350\047\266\345\074\233\365\206\271\350\266\221\133\011\302"
	"\176\377\063\136\132\204\373\201\263\237\233\262\137\233\245\017"
	"\004\301\175\075\254\254\026\245\350\202\162\126\114\375\273\354"
	"\162\227\102\167\033\235\300\001\017\370\234\061\027\176\027\175"
	"\006\137\303\023\035\200\322\301\262\371\211\206\332\374\230\053"
	"\157\267\173\032\164\004\035\173\245\320\002\005\127\325\305\212"
	"\351\071\050\375\350\037\024\304\151\365\204\207\315\334\002\005"
	"\077\127\321\115\342\240\210\272\334\153\317\221\231\315\153\320"
	"\072\366\266\062\066\220\320\005\322\222\257\002\145\170\145\324"
	"\177\303\245\261\361\374\255\062\012\200\044\111\106\225\177\351"
	"\252\014\143\370\351\332\076\067\254\031\326\273\032\357\215\066"
	"\077\057\300\131\272\263\163\347\346\231\366\042\105\141\130\223"
	"\205\222\230\130\332\003\266\131\261\076\371\072\302\366\263\347"
	"\361\365\177\176\364\204\045\327\042\355\001\302\343\357\326\324"
	"\140\355\333\053\323\316\125\120\357\152\343\012\056\106\044\146"
	"\223\237\374\030\171\275\247\263\060\260\317\240\375\073\377\020"
	"\052\154\321\214\133\136\370\172\352\126\204\037\055\171\010\240"
	"\174\104\270\006\371\214\265\345\341\213\273\224\163\114\374\220"
	"\351\224\121\240\201\142\377\377\355\142\363\124\222\125\164\363"
	"\261\174\073\271\132\071\135\147\076\326\107\304\043\360\120\010"
	"\260\027\127\162\345\122\134\076\266\272\273\226\275\156\136\046"
	"\332\245\003\060\223\331\115\345\147\317\313\101\341\025\027\207"
	"\040\036\351\075\065\377\133\263\206\152\212\015\025\316\321\123"
	"\366\137\216\350\322\173\333\115\304\311\367\053\322\063\044\061"
	"\203\300\063\111\011\014\156\334\322\275\354\156\063\063\355\264"
	"\043\167\174\272\146\371\045\317\364\277\232\110\057\376\306\106"
	"\076\310\054\246\102\007\341\110\273\110\000\223\031\240\326\257"
	"\172\162\331\023\124\337\251\210\141\270\104\000\227\276\163\126"
	"\263\055\216\376\242\117\301\120\110\012\017\277\304\027\377\270"
	"\253\256\150\244\317\152\332\250\236\224\344\345\003\242\317\016"
	"\320\136\015\163\256\316\303\366\330\323\266\235\353\265\126\226"
	"\144\276\073\063\051\025\334\310\252\300\255\255\143\175\274\063"
	"\334\311\246\213\227\152\202\160\076\070\015\051\356\143\277\122"
	"\042\373\206\114\021\143\024\273\043\302\150\207\100\044\272\035"
	"\355\141\250\205\314\052\366\012\143\004\063\121\147\363\244\212"
	"\356\053\327\377\216\353\272\262\256\043\071\357\107\364\014\065"
	"\125\265\273\042\340\261\054\103\265\140\225\035\123\072\250\102"
	"\145\177\101\363\153\373\245\032\037\337\011\146\323\026\234\051"
	"\314\130\113\254\011\170\360\277\331\205\335\055\277\205\157\044"
	"\005\260\030\160\254\276\213\313\235\224\062\161\252\317\232\166"
	"\047\346\043\061\137\023\360\070\231\316\146\130\123\325\175\130"
	"\206\226\311\063\124\124\377\362\351\062\143\224\001\376\013\051"
	"\344\056\132\104\102\113\175\333\031\343\064\155\270\261\306\077"
	"\110\220\162\234\344\162\216\316\244\362\142\245\360\155\317\325"
	"\234\052\031\336\165\226\271\217\171\356\375\062\237\303\162\350"
	"\123\344\204\070\127\023\006\373\006\150\241\366\326\160\314\162"
	"\232\345\120\020\174\012\240\365\370\235\050\230\140\232\200\264"
	"\177\005\354\326\031\363\322\037\133\163\026\062\343\342\244\176"
	"\307\365\216\103\000\057\071\371\314\142\221\054\375\022\341\174"
	"\027\315\123\060\300\045\120\034\230\146\116\174\110\363\372\017"
	"\351\211\123\351\271\215\342\205\360\164\262\355\206\223\152\236"
	"\141\275\317\041\343\037\076\174\205\215\370\315\200\363\335\151"
	"\175\061\123\066\277\066\274\257\252\156\234\061\001\007\320\142"
	"\305\237\204\250\277\302\044\105\120\035\022\320\021\360\072\217"
#define      date_z	1
#define      date	((&data[7317]))
	"\217"
#define      tst2_z	19
#define      tst2	((&data[7321]))
	"\221\157\360\376\072\314\163\053\277\107\161\132\237\044\044\072"
	"\202\050\173\235\126\276\056\240"
#define      chk2_z	19
#define      chk2	((&data[7343]))
	"\125\323\245\074\136\165\022\071\203\161\362\236\213\115\316\372"
	"\014\032\312\016\372\020"
#define      pswd_z	256
#define      pswd	((&data[7405]))
	"\234\307\025\354\345\050\275\366\030\370\205\073\206\113\035\112"
	"\315\256\272\276\334\133\260\022\314\005\014\335\337\257\255\173"
	"\167\302\150\134\352\046\123\003\036\022\060\050\337\347\306\260"
	"\223\027\275\037\110\246\161\264\043\331\162\211\063\074\224\022"
	"\232\273\007\355\012\263\367\221\306\050\271\246\017\200\126\242"
	"\230\024\302\340\272\063\225\335\015\007\147\100\104\374\122\337"
	"\267\132\314\301\016\304\123\324\354\014\172\373\214\321\236\044"
	"\345\141\005\240\225\232\175\242\242\345\342\347\341\065\306\231"
	"\220\223\133\236\127\256\163\103\272\356\077\107\300\335\154\246"
	"\076\161\106\324\014\304\166\257\251\130\226\212\216\134\043\036"
	"\357\176\275\107\055\060\212\350\037\311\057\340\247\234\206\346"
	"\015\314\272\032\220\060\311\072\211\137\304\027\274\350\065\254"
	"\147\362\363\224\043\176\175\103\107\254\043\357\111\251\325\127"
	"\166\217\161\007\277\073\101\110\233\006\140\130\357\225\005\126"
	"\210\370\353\254\167\150\357\277\025\023\256\136\275\203\266\064"
	"\022\047\073\322\143\175\033\376\204\173\126\163\021\133\311\231"
	"\124\265\105\313\036\065\213\063\110\071\222\005\274\110\071\317"
	"\160\165\242\323\363\275\322\167\070\050\352\112\204\264\343\330"
	"\151\051\244\207\136\057\273\247\150\331\076\244\045\134\357\363"
	"\012\251\261\347\005\141\371\321\146\006\256\105\266\134\301\055"
	"\036\052\212\011\120\336\014\156\270\113\023\335\247\002\320\262"
	"\254\201\231\261\343\223\203\112\231\062\217\120\216"
#define      lsto_z	1
#define      lsto	((&data[7713]))
	"\150"
#define      tst1_z	22
#define      tst1	((&data[7714]))
	"\105\300\051\067\164\150\227\023\161\063\253\240\142\234\005\201"
	"\067\337\160\156\121\365\313\347\302\072"
#define      msg2_z	19
#define      msg2	((&data[7740]))
	"\023\144\055\345\126\166\110\175\201\137\175\317\134\037\216\001"
	"\304\124\077\174"
#define      opts_z	1
#define      opts	((&data[7760]))
	"\253"
#define      msg1_z	65
#define      msg1	((&data[7777]))
	"\003\257\262\226\062\374\060\144\214\200\362\336\376\237\131\007"
	"\242\061\245\214\276\073\024\071\107\107\107\344\311\032\377\362"
	"\154\204\034\355\314\364\355\076\321\373\312\001\267\142\375\015"
	"\361\343\111\341\246\363\004\211\063\014\355\154\057\065\260\341"
	"\063\245\040\210\210\306\244\220\101\223\140\000\266\320\145\054"
	"\352\125\045\356\027\137\216\046\254\012\335\375\130\106"
#define      shll_z	10
#define      shll	((&data[7855]))
	"\250\201\344\302\106\370\050\363\257\267"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
